上一次我们成功完成了环境的配置，这一次我们来制作一个能跑的 OS~

制作 OS 的主要流程：
1. 编写 .asm Nasm 汇编文件（后期可能还有 C）；
2. 使用 Nasm 将 .asm 文件编译为二进制文件 .bin；
3. 使用 Cygwin 模拟 Linux 环境将 .bin 转换为 .img 软盘文件；
4. 使用 VMWare 运行测试它。

今天我们不干别的事，就只用让 OS 输出 Hello world，然后停下就好了。\
首先，先创建一个文件夹，在文件夹里创建一个 OS.asm 文件，注意不要创建成 OS.asm.txt!\
接着，用记事本或者别的文本编辑器编辑这个 OS.asm 文件的内容，将其变成 OS1.asm 的样子。\
OS1.asm 放在这个项目的 02 Hello world 文件夹里了。

内容看似多，但是实则是重复，让我们来分析一下内容。\
首先，`[org 0x7c00]` 是让程序从 0x7c00，就是引导扇区开始执行。\
`start:` 和 `.print:` 相当于一个 C 中的标签，可以用 `jmp` 之类的命令让程序回到标签的地方继续执行。\
第 4 到第 15 行是清屏并且让光标回到左上角，别管他写的都是啥。

接着，重点部分来了：
- `mov a, b`： 这条语句的作用是将 b 中的内容复制到 a 中，比如 `mov ah, 0x0E` 就是将 ah 的值设为 0x0E；
- `int a`： 这句话的意思是执行一个 a 的命令，比如当 ah = 0x0E 时执行 `int 0x10` 就是打印寄存器 al 中的值；
- 寄存器 ah, al： 这两个寄存器实际上是累加寄存器 ax 的高低 8 位，其实说可以理解为 ah 就是执行什么函数，al 就是参数的一个；
- 0x0D, 0x0A： 这两个 16 进制量相当于 C++ 中的 Windows 换行 "\r\n"，一个负责换行，一个负责将光标移动到最左边。

那么结合以上的知识，我们就能知道：
1. `mov ah, 0x0E` 是让程序进入打印模式；
2. `mov al, 'H'` 是将 H 赋值给 al 寄存器；
3. `int 0x10` 是在屏幕中打印 al 中的值，也就是 H。

值得注意的是，`int 0x10` 其实是相当于这样的，假设 ah 是一个函数，那 `int 0x10` 就是执行 `ah(...)`，`...` 指的是 al 之类的参数。\
写完之后保存，并打开存放 OS.asm 程序的目录，在地址栏里输入 cmd，就会弹出一个小黑框，输入 `nasm -f bin OS.asm -o OS.bin`。\
如果你的程序和指令写的相当正确，那么小黑框里应该没有什么特别的东西；如果有问题，会显示报错信息，更改就行了，然后再试一遍。

现在你已经有了 .bin 文件，是时候将其编译为 .img 文件了。\
进入 Cygwin 安装目录，点击运行 Cygwin.bat，在弹出的框里输入以下内容：
```
cd /
dd if=/dev/zero of=OS.img bs=512 count=2
dd if=你的bin文件存放的地址 of=OS.img bs=512 count=1
```
比如，假设你将 bin 文件存放在 `D:\OS\OS1\OS.bin`，那么第三行就该输入 `dd if=D:/OS/OS1/OS.bin of=OS.img bs=512 count=1`。\
注意，输入的地址打的是 `/` 不是 `\`，不然会出问题！\
现在把黑框关掉，目录里应该会多出一个 OS.img，这就是软盘文件。

最后一步，也是最激动人心的一步，就是启动它！\
打开 VMWare，找到你的虚拟机，点两下，在设备一栏中找到 "软盘"，点一下。\
接着把选项改为 "选择软盘映像文件"，再点一下浏览，选择刚才的 OS.img，最后确定。\
最后，点一下 "开启此虚拟机"，可能会弹出来一个框说 XXX 东西加载失败，不要管他，选否，然后你就能看到 Hello world 啦！
